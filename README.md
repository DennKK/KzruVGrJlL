# Тестовое задание для GreenAtom CaseLab

(Название репозитория изменено, чтобы он не отображался в поиске)

## Описание проекта

Данный проект представляет собой микросервис для хранения файлов и их атрибутов. Микросервис предоставляет HTTP API для
загрузки и получения файлов, а также для работы с их метаданными.

## Основная часть (ВАЖНО) Все основные требования выполнены

### 1. Загрузка файла

Микросервис поддерживает HTTP POST метод для загрузки файлов. В запросе передаются данные в формате JSON, содержащие
файл в формате base64, а также его атрибуты: название, дата и время создания, краткое описание. При успешной загрузке
сервер возвращает уникальный идентификатор файла.

### 2. Получение файла

Для получения загруженного файла реализован HTTP GET метод. Клиент отправляет запрос с уникальным ID файла, в ответе
возвращается JSON, включающий файл в формате base64 и его атрибуты.

### 3. Хранение данных

Для хранения файлов и их метаданных используется реляционная база данных PostgreSQL.

## Дополнительная часть (ВАЖНО) Все дополнительные требования выполнены

- **Получение списка файлов:** Реализован метод для получения списка всех файлов с поддержкой пагинации и сортировки по
  времени создания. Сортировка производится в убывающем порядке по дате создания.
- **Покрытие тестами:** Проект полностью покрыт юнит-тестами с использованием JUnit и Mockito. Для анализа покрытия
  тестами используется плагин JaCoCo, отчет о покрытии доступен в папке `target/site/jacoco/index.html`.
- **Контейнеризация:** Микросервис и база данных PostgreSQL упакованы в Docker-контейнеры для удобства развертывания и
  использования. Дополнительно, для управления базой данных через веб-интерфейс включен контейнер с pgAdmin.

## Упрощение документирования и тестирования

**Swagger UI:** Для упрощения тестирования и документирования API включен Swagger UI, который доступен по
адресу `/api-docs` или `/swagger-ui/index.html`.

## Примеры тестовых запросов (ВАЖНО)

### 1. Загрузка нового файла

- **Метод:** POST
- **URL:** [http://localhost:8080/api/v1/files/upload](http://localhost:8080/api/v1/files/upload)

**Тело запроса (JSON):**
`
{
  "fileData": "VGhpcyBpcyB0aGUgZmlsZSBkZXNjcmlwdGlvbg==",
  "title": "File title",
  "description": "This is the file description."
}`

### 2. Получение списка файлов с пагинацией

- **Метод:** GET
- **URL:** [http://localhost:8080/api/v1/files](http://localhost:8080/api/v1/files)

**Параметры запроса:**

- **page:** номер страницы (по умолчанию: 0)
- **size:** количество файлов на странице (по умолчанию: 2)
- **sortBy:** поле для сортировки (по умолчанию: creationDate)

**Пример запроса:**
`GET http://localhost:8080/api/v1/files?page=0&size=2&sortBy=creationDate`

### 3. Получение деталей файла по ID

- **Метод:** GET
- **URL:** [http://localhost:8080/api/v1/files/{fileId}](http://localhost:8080/api/v1/files/{fileId})

**Пример запроса:**
`GET http://localhost:8080/api/v1/files/1`

## Инструкция по запуску (ВАЖНО)

### Клонирование репозитория

Склонируйте репозиторий на ваш локальный компьютер.

### Запуск с использованием Docker

Перейдите в корневую директорию проекта и выполните команду: `docker-compose up`
Это запустит микросервис, базу данных PostgreSQL и pgAdmin.

### Доступ к Swagger UI

После запуска перейдите по
адресу [http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html), чтобы ознакомиться с
API.

### Доступ к базе данных PostgreSQL через pgAdmin

После запуска проекта с использованием Docker, вы можете получить доступ к базе данных через веб-интерфейс pgAdmin.
pgAdmin будет доступен по следующему адресу:

- **URL:** [http://localhost:5055](http://localhost:5055)
- **Электронная почта:** admin@admin.com
- **Пароль:** admin

#### Создайте новое подключение к базе данных:

1. Выберите пункт **"Servers"**.
2. В появившемся окне введите следующие данные:

- **Name (Имя):** CaseLab-DB

3. Перейдите на вкладку **"Connection" (Подключение)** и укажите следующие параметры:

- **Host name/address (Имя хоста/адрес):** caselab-db-service (это имя сервиса базы данных в Docker Compose)
- **Port (Порт):** 5432
- **Maintenance database (База данных):** postgres
- **Username (Имя пользователя):** postgres
- **Password (Пароль):** postgres

4. Сохраните и подключитесь.

### Тестирование

В проекте реализованы юнит-тесты. Для их выполнения используйте команду: `mvn test`
Отчет о покрытии тестами будет сгенерирован и доступен в папке `target/site/jacoco/index.html`.
